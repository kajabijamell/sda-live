<div class="row">
  <div class="col-12">
    <%= form_with(model: admin_media_sermon, local: true) do |form| %>

      <div class="form-group">
        <%= form.label :video %>
        <% if admin_media_sermon.get_video_url.present? %>
          <%= video_tag(admin_media_sermon.get_video_url, class: 'video', height: 300, controls: true, poster: admin_media_sermon.get_thumbnail_url)  %>
        <% end %>
        <%= form.file_field :video, accept: 'video/*'  %>
      </div>

      <div class="form-group">
        <%= form.label :title %>
        <%= form.text_field :title, class: 'form-control' %>
      </div>

      <div class="form-group">
        <%= form.label :speaker %>
        <%= form.text_field :speaker, class: 'form-control' %>
      </div>

      <div class="form-group">
        <%= form.label :scripture %>
        <%= form.text_field :scripture, class: 'form-control' %>
      </div>

      <div class="form-group">
        <%= form.check_box :published %>
        <%= form.label :published %>
      </div>

      <div class="actions">
        <%= form.submit 'Save', class: 'btn btn-primary' %>
      </div>
    <% end %>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
    let videos = document.getElementsByClassName('video');
    length = videos.length
    for (let i = 0; i < length; i++) {
        let videoSrc = videos[i].src;
        if (Hls.isSupported() && videoSrc.indexOf('.m3u8') !== -1) {
            const hls = new Hls();
            hls.loadSource(videoSrc);
            hls.attachMedia(videos[i]);
        }
        else if (videos[i].canPlayType('application/vnd.apple.mpegurl')) {
            videos[i].src = videoSrc;
        }
    }
</script>